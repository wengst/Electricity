<!DOCTYPE HTML>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta http-equiv="pragma" content="no-cache" />
    <meta http-equiv="cache-control" content="max-age=604800" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>电学实验箱</title>

    <!-- jQuery -->
    <script src="js/jquery-2.0.0.min.js" type="text/javascript"></script>

    <!-- Bootstrap4 files-->
    <script src="js/bootstrap.bundle.min.js" type="text/javascript"></script>
    <link href="css/bootstrap.css" rel="stylesheet" type="text/css" />

    <!-- Font awesome 5 -->
    <link href="fonts/fontawesome/css/all.min.css" type="text/css" rel="stylesheet">

    <!-- custom style -->
    <link href="css/ui.css" rel="stylesheet" type="text/css" />
    <link href="css/responsive.css" rel="stylesheet" media="only screen and (max-width: 1200px)" />
    <style>
        .margin-16 { margin-left: 16px; }
        .margin-32 { margin-left: 32px; }
    </style>
</head>
<body>
    <a name="Top"></a>
    <section class="section-name padding-y bg">
        <div class="container">
            <div class="row">
                <div class="col-6-md">
                    <a class="btn btn-gray-light" href="#content">简介</a>
                    <a class="btn btn-gray-light" href="#help">帮助</a>
                    <a class="btn btn-gray-light" href="#download">下载</a>
                    <a class="btn btn-gray-light" href="#design">开发笔记</a>
                    <a class="btn btn-gray-light" href="#about">关于作者</a>
                    <a class="btn btn-gray-light" href="https://shop34941065.taobao.com/" target="_blank">仙舟杂货铺</a>
                    <a class="btn btn-gray-light" href="https://www.douyin.com/user/MS4wLjABAAAALMcYL4g8wPJUYvnc9a2NRVc4jsdaYiXAnBNLF_ttgM0" target="_blank">抖音</a>
                </div>
            </div>
        </div>
    </section>

    <section class="section-name padding-y bg">
        <div class="container">
            <div class="row">
                <div class="col-12-md"><h3>2022.11.16 更新</h3></div>
            </div>
            <div class="row">
                <div class="col-12-md">
                    <p>
                        <span class="margin-32"><b>版本更新至 1.1.0.0</b></span>
                    </p>
                    <p>
                        <ul>
                            <li>工具栏按钮由文字改成图标，缩短了工具栏长度</li>
                            <li>增加文件工具，实现将电路导出为电路实物图、和文本格式的电路文件，打开文本格式的电路文件</li>
                        </ul>
                    </p>
                </div>
            </div>
            <div class="row">
                <img src="images/main_image_1.1.0.0.jpg" class="img-fluid" />
            </div>
        </div>
    </section>

    <section class="section-name padding-y bg">
        <div class="container">
            <div class="row">
                <div class="col-12-md"><h3>2022.11.12 更新</h3></div>
            </div>
            <div class="row">
                <div class="col-12-md">
                    <p>
                        <span class="margin-32"><b>版本更新至 1.0.0.3</b></span>
                    </p>
                    <p>
                        <ul>
                            <li>修正串联电路/基本电路判断成串联电路的问题</li>
                            <li>对于可修改的元件参数，将单位跟随到数字后面</li>
                            <li>屏蔽掉一些无关属性</li>
                            <li>如果存在桥电路，增加了哪条支路是桥的显示输出</li>
                        </ul>
                    </p>
                </div>
            </div>
        </div>
    </section>

    <a name="content"></a>
    <section class="section-name padding-y bg">
        <div class="container">
            <div class="row">
                <div class="col-6-md"><h3>简介</h3></div>
                <div class="col-6-md"><a class="btn btn-sm" href="#Top">Top</a></div>
            </div>
            <div class="row">
                <div class="col-12-md">
                    <img src="images/electricity1.jpg" class="img-fluid" />
                </div>
            </div>
            <div class="row">
                <div class="col-12-md">
                    <h4>2022年10月31日</h4>
                    <p>在电脑上做初中电学实验</p>
                    <p>电学实验箱有电源、电压表、电流表、小灯泡、电阻器、滑动变阻器、开关等元件。使用者把它们放置到工作台上，调整它们的位置，使用鼠标拖动连接各个元件，形成电路。</p>
                    <p>连接无误，单击【分析计算】按钮，软件会对电路进行分析，判断电路的连接特点，并进行计算，得到流过各个用电器的电流，电器两端的电压。</p>
                    <p>要想查看各个电器元件的电流和电压，点击各个电器元件，右边的属性栏就会显示它们。</p>
                    <p>如果想改变元件的初始值，比如滑动变阻器的最大电阻，电阻器的电阻，小灯泡的额定电压、额定功率，同样通过右边的属性栏操作。</p>
                    <p>目前，软件的第一个版本正在制作中，不久就会提供下载</p>
                </div>
            </div>
        </div>
    </section>

    <a name="help"></a>
    <section class="section-name padding-y bg">
        <div class="container">
            <div class="row">
                <div class="col-6-md"><h3>使用帮助</h3></div>
                <div class="col-6-md"><a class="btn btn-sm" href="#Top">Top</a></div>
            </div>
            <div class="row">
                <div class="col-12-md">
                    <p>软件运行环境：Windows 7/8/10/11 操作系统。绿色版本，无需安装，下载即可使用</p>
                    <p>下载软件：下载下来的文件是一个RAR文件，需要解压缩。任何可解压缩的软件都可以，比如WinRar、UnZip、......。</p>
                    <p>把文件解压到一个文件夹中，双击“电学实验箱.exe”即可运行</p>
                    <p><h5 class="margin-16">主题 <a class="btn btn-sm" href="#Top">Top</a></h5></p>
                    <p><span class="margin-32"> 主题其实就是配色，根据自己的喜好选择</span></p>
                    <p><h5 class="margin-16">工具箱 <a class="btn btn-sm" href="#Top">Top</a></h5></p>
                    <p><span class="margin-32">工具箱中有电源，电阻、滑动变阻器、小电动机、小灯泡、开关、电流表和电压表八种。每种有数量限制，电源一个，电动机2个，小灯泡4个，电阻器4个，滑动变阻器2个，开关4个，电流表和电压表各3个</span></p>
                </div>
            </div>
            <div class="row">
                <div class="col-12-md">
                    <img src="images/allElements.jpg" class="img-fluid" />
                </div>
            </div>
            <div class="row">
                <div class="col-12-md">
                    <p><h5 class="margin-16">连接电路 <a class="btn btn-sm" href="#Top">Top</a></h5></p>
                    <p><span class="margin-32">单击工具按钮，电器元件就摆放到工作台上，然后可拖动电器元件到适当的位置。</span></p>
                    <p><span class="margin-32">鼠标移到红色或黑色的接线柱上，按下鼠标左键并移动鼠标，可拖出一条导线。移动导线一端到另一个电器的接线柱上。这样就连接了两个电器元件。</span></p>
                    <p><span class="margin-32">如果导线遮挡了电器元件，单击导线，会出现两个白色圈圈和两个红色圈圈。两个白色圈圈是控制导线弯曲程度的控制点，拖动它们可改变导线弯曲度。红色圈圈是导线的端点控制点，拖动它们可将导线从接线柱上取下或更换接线柱。</span></p>
                    <p><span class="margin-32">连接到电器元件的导线呈现暗红色，没有连接到元件或只连接了一个元件的导线呈现灰色，有电流流过的导线呈现蓝色</span></p>
                </div>
            </div>
            <div class="row">
                <div class="col-12-md">
                    <img src="images/wirecolors.jpg" class="img-fluid" />
                </div>
            </div>
            <div class="row">
                <div class="col-12-md">
                    <p><h5 class="margin-16">分析和计算 <a class="btn btn-sm" href="#Top">Top</a></h5></p>
                    <p><span class="margin-32">电路分析和计算有两种方式：自动和手动，默认是自动方式。</span></p>
                    <p><span class="margin-32"><b>自动方式：</b>通过单击开关，开关可改变通断状态，开关状态变化，程序自动分析和计算。通过移动滑动变阻器的滑片，程序也能自动分析和计算。</span></p>
                    <img src="images/switchClosed.png" />&nbsp;&nbsp;&nbsp;&nbsp;<img src="images/switchOpen.png" />&nbsp;&nbsp;&nbsp;&nbsp;<img src="images/rheostatNormal.png" />
                    <p><span class="margin-32"><b>手动方式：</b>单击“选项”按钮，调出选项对话框，叉掉自动分析和计算，则每次电路变化都要手动点击【分析和计算】才会进行电路分析和计算。</span></p>
                </div>
            </div>
            <div class="row">
                <div class="col-12-md">
                    <img src="images/options.jpg" class="img-fluid" />
                </div>
            </div>
            <div class="row">
                <div class="col-12-md">
                    <p><h5 class="margin-16">查看计算结果 <a class="btn btn-sm" href="#Top">Top</a></h5></p>
                    <p><span class="margin-32">单击元件，可在右侧的属性列表中查看电压、电流等数据</span></p>
                </div>
            </div>
            <div class="row">
                <div class="col-12-md">
                    <img src="images/workingCircuit.jpg" class="img-fluid" />
                </div>
            </div>
            <div class="row">
                <div class="col-12-md">
                    <p><h5 class="margin-16">电流表和电压表的缩放 <a class="btn btn-sm" href="#Top">Top</a> </h5></p>
                    <p><span class="margin-32">选中电流表或电压表，滚动鼠标滚轮，可缩放电流表和电压表。最多放大到4倍。</span></p>
                    <img src="images/ammeter4XInit_RedPointer.png" />&nbsp;&nbsp;&nbsp;&nbsp;<img src="images/voltmeter4XInit.png" />
                    <p><h5 class="margin-16">电源电压、电阻是否可更改？ <a class="btn btn-sm" href="#Top">Top</a></h5></p>
                    <p><span class="margin-32">可以更改。单击元件，凡是文字颜色是黑色的，都是可更改的。目前更改后不能对整个电路进行自动计算，需要通断开关一次或手动点击“分析和计算”</span></p>
                    <p><h5 class="margin-16">已知的BUG <a class="btn btn-sm" href="#Top">Top</a></h5></p>
                    <p><span class="margin-32">如图所示，把并联电路给分析成了串联电路</span></p>
                </div>
            </div>
            <div class="row">
                <div class="col-12-md">
                    <img src="images/parallel circuit.jpg" class="img-fluid" />
                </div>
            </div>
            <div class="row">
                <div class="col-12-md">
                    <p><span class="margin-32">如果在使用中发现有新的Bug，请联系作者。微信：13858145960</span></p>
                    <p><h5 class="margin-16">PS：软件将不断改进，优化，增加更多的元器件，今后若有新版本发布，将在本站公布、下载。</h5></p>
                </div>
            </div>
        </div>
    </section>

    <a name="download"></a>
    <section class="section-name padding-y bg">
        <div class="container">
            <div class="row">
                <div class="col-6-md"><h3>下载</h3></div>
                <div class="col-6-md"><a class="btn btn-sm" href="#Top">Top</a></div>
            </div>
            <div class="row" style="margin-bottom:16px;">
                <div class="col-12-md">
                    <a href="publish/Electricity1.1.0.0.RAR" class="btn btn-primary">初中电学实验箱1.1.0.0 for Windows</a>
                </div>
            </div>
            <div class="row" style="margin-bottom:16px;">
                <div class="col-12-md">
                    <a href="publish/Electricity1.0.0.3.RAR" class="btn btn-primary">初中电学实验箱1.0.0.3 for Windows</a>
                </div>
            </div>
            <div class="row" style="margin-bottom:16px;">
                <div class="col-12-md">
                    <a href="publish/Electricity1.0.rar" class="btn btn-primary">初中电学实验箱1.0版 for Windows</a>
                </div>
            </div>
            <div class="row">
                <div class="col-12-md">
                    <a href="publish/Electricity.rar" class="btn btn-primary">截至2022.11.24的源代码 C# VS2022 43.1MB</a>
                </div>
            </div>
        </div>
    </section>

    <a name="design" />
    <section class="section-name padding-y bg">
        <div class="container">
            <div class="row">
                <div class="col-6-md">
                    <h3>软件开发笔记</h3>
                </div>
                <div class="col-6-md">
                    <a class="btn btn-sm" href="#Top">Top</a>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <p><span class="margin-16">开发工具和框架：Visual Studio 2019 ; .Net Farmework 4.7 ; C#</span></p>
                    <p><span class="margin-16">动态链接库 ElectricityDLL.dll是软件的核心部分。该动态链接库自定义了工作台控件Workbench（从Panel继承）。工作台控件定义了鼠标Down/Move/Up方法用于元件的拖放、导线绘制和控制、滑动变阻器的滑动、开关的断开闭合等操作。</span></p>
                    <p><span class="margin-16">库中还有各元件的类型，所有元件的基类型是EleComponent，直接继承的子类型有Element（用电器、开关、仪表、电源的基类）、Wire（导线）、Terminal（接线柱）、Junction（接头或导线控制点）、Knify（开关的刀）、Vane（滑片）、Pointer（仪表指针）。</span></p>
                    <p><span class="margin-16">Element类型有List&lt;Terminal&gt; Terminals属性，记录每个用电器所有的接线柱，每个接线柱有List&lt;Junction&gt; Junctions属性，记录导线接头。每条导线Wire有四个Junction实例，即导线的起止端点和两个曲线控制点。</span></p>
                    <p><span class="margin-16">为了能独立或批量移动工作台上的元件，建立一个DragDropInfo类，记录鼠标Down/Move/Up的鼠标初始位置坐标，执行更新后的位置坐标、当前位置坐标，选中对象集合等信息。为了能将拖动信息传递给外部调用方法。创建OnStatusChanged事件代理和参数StatusChangedEventArgs。</span></p>
                    <p><span class="margin-16">为了进行电路分析和计算，创建PathElement类和ElePath类。因为每一条电路都是类似于电源右接线柱-&gt;导线1-&gt;开关右接线柱-&gt;......；和/或开关右接线柱-&gt;开关-&gt;开关左接线柱-&gt;......。而这个PathElement类就是电路的最小单元，它包括三个EleComponent对象实例，即两端是接线柱，中间是用电器/电源/导线。而ElePath则可以算是PathElement的集合。但我把ElePath作为抽象类，真正用于分析电路的是它的两个子类型：Branch和Circuit。</span></p>
                    <p><span class="margin-16">Branch类型：用于描述支路的类型，它的特点是所有中间接线柱的导线连接数只有1条，两端接线柱的导线连接数都是2条或2条以上。支路可能只是一条导线，或者是包含电源，或者是含有用电器。</span></p>
                    <p><span class="margin-16">Circuit类型：用于描述回路的类型，它的特点是闭合，即Start接线柱和End接线柱相同。Circuit回路是由一段或多段Branch支路构成，而一段Branch支路可能在一条或多条Circuit回路中存在。</span></p>
                    <p><span class="margin-16">另外还创建一个Node节点类型。Node类型用于描述电势相同的各接线柱的集合。</span></p>
                    <p><span class="margin-16">要进行电路分析，就要先查找Circuit、Branch、Node，构建Circuit、Branch和Node的集合。</span></p>
                    <p><span class="margin-16">第1步，遍历所有工作台上的元器件，把有导线相连的接线柱/导线/元件/接线柱实例化成PathElement的集合。然后以包含电源的PathElement开始从List&lt;PathElement&gt;列表中遍历搜索能和它相连的PathElement实例，相连后构建Circuit和Branch，构建Circuit和Branch的集合。</span></p>
                    <p><span class="margin-16">第2步，遍历所有的Terminal集合，根据电阻属性，把相连电阻为零的接线柱合并成一个节点。位于该节点中的所有接线柱的电势都是相同的。</span></p>
                    <p><span class="margin-16">第3步，去除那些不合法的回路和支路。在支路和回路查找过程中，由于查询方法的缘故，会将一些重复电路，不完整电路也添加到集合，所以需要将它们除去。</span></p>
                    <p><span class="margin-16">第4步，查找能构建线性代数公式的支路和回路。如果是初中学生做题，会去利用欧姆定律，串联电路的电压特点、电流特点，并联电路的电压特点和电流特点等列写公式，使每个式子只有一个未知量。显然这是无法办到的。我是希望这个软件能更通用些。查阅相关书籍，知道有基尔霍夫定律（节点电流法、回路电压法）可用。</span></p>
                    <p><span class="margin-16">节点电流：即流入节点的电流等于流出节点的电流，如果用公式表示就是类似于：I<sub>1</sub>+I<sub>2</sub>=I<sub>3</sub>这样的式子。而回路电压的意思是回路中各用电器两端电压之和等于电源电压。即类似于：U<sub>1</sub>+U<sub>2</sub>=U<sub>电源</sub></span></p>
                    <p><span class="margin-16">为表示公式，创建Equation类型，包含List&lt;double&gt; Coefficients系数属性和double Vecotr属性。</span></p>
                    <p><span class="margin-16">第5步，构建公式。不是每条支路都能用于公式计算，那些电阻为零的支路不参与线性代数公式组的计算。所以要把那些电阻不为零的支路找出来，归集到一个集合。支路在集合中的索引值就作为线性代数方程组的未知量下标，支路电阻作为系数，如果是回路电压方程，回路总电压作为Equation实例的Vector的值，如果是节点电流，Equation的Vector等于零。</span></p>
                    <p><span class="margin-16">构建出方程组后，进行方程组的消元求解计算，这里曾尝试自己编写消元解法，由于线性代数基础不够好，所以解出来的数据不对。换用MathNet.Numeric程序集，问题解决。（PS：主要是一开始的时候把线性相关的方程给加入到方程组，导致方程组无解或有多解）得到方程组的解。</span></p>
                    <p><span class="margin-16">有了解，再根据支路间的关系，把有效的支路的电流进行赋值，计算支路电压，展现通电效果</span></p>
                </div>
            </div>
        </div>
    </section>
    </a>

    <a name="about"></a>
    <section class="section-name padding-y bg">
        <div class="container">
            <div class="row">
                <div class="col-6-md"><h3>关于作者</h3></div>
                <div class="col-6-md"><a class="btn btn-sm" href="#Top">Top</a></div>
            </div>
            <div class="row">
                <div class="col-12-md">
                    <p><span class="margin-16">作者曾经是公校的科学(浙江省初中物理、化学、生物的综合学科)老师，从教25年，喜欢计算机。现在离职在家，空余时间给孩子们补补课。自学计算机语言，会些C#、Javascript、Html，因为在教学生电学知识的时候，感觉趣味性不够，就制作了一个模拟简单电路的APP，上电学课时候用。</span></p>
                    <p><span class="margin-16">不过软件再怎么好，也没有实际电路好。我的<a href="https://shop34941065.taobao.com" target="_blank">淘宝店铺</a>中就有实体的电学实验箱出售，把自己创作的实验视频放在<a href="https://www.douyin.com/user/MS4wLjABAAAALMcYL4g8wPJUYvnc9a2NRVc4jsdaYiXAnBNLF_ttgM0" target="_blank">我的抖音</a>。今后不仅要把电学实体器件的实验充实和完善，还要把初中科学的一些知识课程放上去。</span></p>
                    <p><span class="margin-16"><b>家教：</b>杭州西湖、之江、上城、下城、拱墅、钱塘、滨江、萧山、余杭、富阳的学生，如果需要初中科学辅导的，建议先准备好需要解答的问题，上门辅导，按次收费。一对一每次600（2小时），一对多每次900（2小时，4人以内），按需补课，随叫随到，提前1~2天联系我即可。国内学生，初中物理、化学、生物线上答疑，按时收费，每小时100，提前12小时联系，联系时提供要解答的问题。</span></p>
                </div>
            </div>
        </div>
    </section>
</body>
</html>